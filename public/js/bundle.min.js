import{key}from"../../public/config.js";const APIkey=key;fetch("../src/html/idea.html").then(e=>e.text()).then(e=>{document.querySelector(".idea").innerHTML=e}),fetch("../src/html/trees.html").then(e=>e.text()).then(e=>{document.querySelector(".trees").innerHTML=e}),fetch("../src/html/sunny.html").then(e=>e.text()).then(e=>{document.querySelector(".sunny").innerHTML=e});class Search{constructor(e){this.query=e}async getWeather(){try{let e=null;e="http:"===location.protocol?`http://api.openweathermap.org/data/2.5/weather?q=${this.query}&APPID=${APIkey}`:`https://api.openweathermap.org/data/2.5/weather?q=${this.query}&APPID=${APIkey}`;let t=await fetch(e),a=await t.json();this.name=a.name,this.temp=a.main.temp-272.15,this.weatherInfo=a.weather[0].main,this.cod=a.cod}catch(e){console.log(e)}}}const input=document.querySelector(".input"),weatherRes=document.querySelector(".results"),result=document.querySelector(".results__temperature span"),form=document.querySelector(".form"),info=document.querySelector(".results__info p"),infoTempHeight=document.querySelector(".temp-info"),sectionResults=document.querySelector(".section-results"),btn=document.querySelector(".check-weather"),advice=document.querySelector(".advice"),city=document.querySelector(".results__city p"),getInput=()=>input.value,clearInput=()=>input.value="",clearResult=()=>result.innerHTML="",renderResult=e=>{const t=Math.round(10*e)/10;result.textContent=t+"°C"},dateToday=()=>{let e=document.querySelector(".date"),t=new Date,a=t.getDate(),o=t.getMonth()+1,n=t.getFullYear();a<10&&(a="0"+a),o<10&&(o="0"+o),n<10&&(n="0"+n),e.textContent=`${a}.${o}.${n}`},showRes=()=>{""===input.value?(input.placeholder="Musisz wpisać miasto",input.style.border="4px solid red"):(input.placeholder="Wpisz miasto",input.style.border="4px solid transparent",weatherRes.classList.add("show-result"),document.body.classList.add("change-bg"),advice.classList.add("typingEffect"),sectionResults.style.display="flex",input.style.width="26rem",setTimeout((function(){weatherRes.classList.remove("show-result"),document.body.classList.remove("change-bg"),advice.classList.remove("typingEffect")}),6500))},state={},controlSearch=async()=>{const e=input.value;if(e){state.search=new Search(e),input.value="";try{if(await state.search.getWeather(),weatherRes.style.display="flex",city.textContent=e.toUpperCase(),200===state.search.cod){renderResult(state.search.temp);let e=state.search.weatherInfo,t=state.search.temp;switch(e){case"Thunderstorm":document.body.style.backgroundImage="url('./img/thunderstorm.jpeg')",info.textContent="Uważaj - burza";break;case"Drizzle":document.body.style.backgroundImage="url('./img/drizzle.jpeg')",info.textContent="Może pojawić się mżawka";break;case"Rain":document.body.style.backgroundImage="url('./img/rain.jpeg')",info.textContent="Nie zapomnij parasola";break;case"Snow":document.body.style.backgroundImage="url('./img/snow.jpeg')",info.textContent="Na pewno pojawi się śnieg";break;case"Mist":document.body.style.backgroundImage="url('./img/mist.jpeg')",info.textContent="Wystąpi lekkie zamglenie";break;case"Smoke":document.body.style.backgroundImage="url('./img/smoke.jpeg')",info.textContent="Niebo może być zadymione";break;case"Haze":document.body.style.backgroundImage="url('./img/haze.jpeg')",info.textContent="Uważaj na mgłę";break;case"Dust":document.body.style.backgroundImage="url('./img/dust.jpeg')",info.textContent="Dzisiaj może wystąpić burza pyłu";break;case"Fog":document.body.style.backgroundImage="url('./img/fog.jpeg')",info.textContent="Dzisiaj pojawi sie mgła";break;case"Sand":document.body.style.backgroundImage="url('./img/sand.jpeg')",info.textContent="Uważaj na burzę piaskową";break;case"Ash":document.body.style.backgroundImage="url('./img/ash.jpeg')",info.textContent="W powietrzu pojawi się popiół wulkaniczny";break;case"Squall":document.body.style.backgroundImage="url('./img/squall.jpeg')",info.textContent="Dzisiaj pojawi się porywisty wiatr";break;case"Tornado":document.body.style.backgroundImage="url('./img/tornado.jpeg')",info.textContent="Uważaj na tornado";break;case"Clear":document.body.style.backgroundImage="url('./img/clear.jpeg')",info.textContent="Ciesz się przejrzystym niebem";break;case"Clouds":document.body.style.backgroundImage="url('./img/cloud.jpg')",info.textContent="Mogą pojawić się chmury";break;default:document.body.style.backgroundImage="url('./img/start.jpeg')"}infoTempHeight.textContent=t>=20?"temperatura będzie wysoka!":t>10&&t<20?"":"temperatura będzie niska!"}else document.body.style.backgroundImage="url('./img/start.jpeg')",result.textContent="Ups...",info.textContent="Niepoprawna nazwa miasta",infoTempHeight.textContent="Spróbuj jeszcze raz :)",advice.textContent="Znajdź swoje miasto :D :D :D"}catch(e){console.log("Something wrong...")}}};form.addEventListener("submit",e=>{e.preventDefault(),controlSearch()}),btn.addEventListener("click",showRes),window.addEventListener("load",dateToday);